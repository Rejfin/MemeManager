FROM node:18-alpine AS builder
WORKDIR /app
COPY ["package.json", "yarn.lock", "./"]
RUN yarn install
COPY . .
RUN ["yarn", "build"]

FROM node:18-alpine AS server
WORKDIR /app
COPY package*.json ./
RUN yarn install --production=true
COPY --from=builder app/build ./build
EXPOSE 3070
CMD ["node", "build/index.js"]